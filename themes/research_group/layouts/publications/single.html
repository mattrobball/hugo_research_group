{{ define "main" }}

<h1> Publications </h1>

<h2> Group highlights </h2> 

 <p> For a full list of publications, <a href="#full-list">see below</a>.</p> <!-- It would be nice to have a link to external repos of published papers for all group members, eg arxiv or mathscinet  -->

<div class="container">
<div class="row">

{{ range .Site.Data.publications }} <!-- loop over all publications in publications.md -->

{{ if .highlight }} <!-- if highlight variable in publication.md is true -->

<div class="col-sm-6 clearfix">
 <div class="well">
  <p><pubtit>{{ .title }}</pubtit></p>
  <p><img src="/images/publications/{{ .image }}" class="img-responsive" width="33%" style="float: left" />
  <p>{{ .abstract }}</p></p>
  <p><em>{{ .authors }}</em> <strong><a href="{{ .url }}">{{ .journal_ref }}</a></strong></p>
  <p class="text-danger"><strong> {{ .news1 }}</strong></p>
  <p> {{ .news2 }}</p>
 </div>
</div>

{{ end }}
{{ end }}

</div>

<!-- Get the unique years of publications and sort them in ascending order -->
{{ $years := slice }}
{{ range .Site.Data.publications }}
	{{ $years = $years | append .year }}
{{ end }}
{{ $years = uniq $years | sort }}
{{ $length := len $years }}

<div class="row">

<h2 id="full-list">Full List </h2> 
<br>
{{$i := 0}} <!-- Initialize a counter to label items uniquely -->
{{ range (seq $length) }} <!-- Loop over a sequence the length equal to the number of years -->
    {{ $year := index $years (sub $length .) }} <!-- Reverse the indexing -->
    
	<h3>{{ $year }}</h3>

    <div class="accordion accordion-flush" id="accordion">

	{{ range where $.Site.Data.publications ".year" $year }} <!-- Loop over all the publications from publications.yml with the matching year -->

    <div class="accordion-item">
        <h2 class="accordion-header" id="flush-heading{{ $i }}">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{ $i }}" aria-expanded="false" aria-controls="flush-collapse{{ $i }}">
            <p><i>{{ .authors }}. </i> {{ .title }}. <a href="{{ .url }}">{{ .journal_ref }}</a></p>
          </button>
        </h2>
        <div id="flush-collapse{{ $i }}" class="accordion-collapse collapse" aria-labelledby="flush-heading{{ $i }}">
          <div class="accordion-body">
            {{ .abstract }}
          </div>
        </div>
    </div>
    
    {{$i = add $i 1}}

	{{ end }}

    </div>

    {{$i = add $i 1}}
{{ end }}

</div>
</div>

{{ end }}